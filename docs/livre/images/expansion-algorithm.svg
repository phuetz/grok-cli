<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 420">
  <defs>
    <linearGradient id="bgGradEA" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="420" fill="url(#bgGradEA)"/>

  <!-- Title -->
  <text x="400" y="28" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">ALGORITHME D'EXPANSION</text>

  <!-- Step 1 -->
  <rect x="40" y="50" width="350" height="70" rx="6" fill="#1e3a3a" stroke="#2ecc71" stroke-width="2"/>
  <text x="60" y="72" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2ecc71">1. RETRIEVAL DE BASE</text>
  <text x="60" y="92" font-family="Arial, sans-serif" font-size="10" fill="#cccccc">Query → RAG classique → Top 5 chunks</text>
  <text x="60" y="108" font-family="monospace" font-size="9" fill="#888888">[chunk1, chunk2, chunk3, chunk4, chunk5]</text>

  <!-- Step 2 -->
  <rect x="410" y="50" width="350" height="70" rx="6" fill="#3a3a1e" stroke="#f39c12" stroke-width="2"/>
  <text x="430" y="72" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#f39c12">2. INITIALISATION</text>
  <text x="430" y="92" font-family="monospace" font-size="9" fill="#cccccc">Queue = [chunk1, chunk2, ...]</text>
  <text x="430" y="108" font-family="monospace" font-size="9" fill="#cccccc">Visited = {}, Results = []</text>

  <!-- Step 3 - BFS Loop -->
  <rect x="40" y="135" width="720" height="200" rx="8" fill="#2d2d44" stroke="#3498db" stroke-width="2"/>
  <text x="60" y="160" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3498db">3. BOUCLE D'EXPANSION (BFS)</text>

  <rect x="60" y="175" width="680" height="145" rx="6" fill="#1a1a2e"/>

  <text x="80" y="198" font-family="monospace" font-size="10" fill="#9b59b6">WHILE</text>
  <text x="130" y="198" font-family="monospace" font-size="10" fill="#cccccc">queue not empty</text>
  <text x="260" y="198" font-family="monospace" font-size="10" fill="#9b59b6">AND</text>
  <text x="295" y="198" font-family="monospace" font-size="10" fill="#cccccc">results &lt; limit:</text>

  <text x="100" y="220" font-family="monospace" font-size="9" fill="#cccccc">chunk = queue.dequeue()</text>
  <text x="100" y="238" font-family="monospace" font-size="9" fill="#9b59b6">IF</text>
  <text x="120" y="238" font-family="monospace" font-size="9" fill="#cccccc">chunk in visited:</text>
  <text x="255" y="238" font-family="monospace" font-size="9" fill="#f39c12">CONTINUE</text>

  <text x="100" y="258" font-family="monospace" font-size="9" fill="#cccccc">visited.add(chunk), results.add(chunk)</text>

  <rect x="100" y="268" width="620" height="45" rx="4" fill="#1e3a3a"/>
  <text x="120" y="285" font-family="monospace" font-size="9" fill="#2ecc71">// Suivre les dependances</text>
  <text x="120" y="300" font-family="monospace" font-size="9" fill="#9b59b6">FOR</text>
  <text x="155" y="300" font-family="monospace" font-size="9" fill="#cccccc">dep IN chunk.imports: dep.score = chunk.score × 0.8</text>
  <text x="120" y="308" font-family="monospace" font-size="9" fill="#cccccc"></text>

  <!-- Step 4 -->
  <rect x="40" y="350" width="720" height="55" rx="6" fill="#2a1e3a" stroke="#9b59b6" stroke-width="2"/>
  <text x="60" y="375" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#9b59b6">4. TRI FINAL</text>
  <text x="60" y="395" font-family="Arial, sans-serif" font-size="10" fill="#cccccc">Results tries par score decroissant → Contexte augmente pour le LLM</text>
</svg>
